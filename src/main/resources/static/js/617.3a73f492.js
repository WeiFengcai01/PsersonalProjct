"use strict";(self["webpackChunkpersonal"]=self["webpackChunkpersonal"]||[]).push([[617],{4617:function(e,t,s){s.r(t),s.d(t,{default:function(){return n}});var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"info"},[s("div",{staticClass:"info_board"},[s("div",{staticClass:"info_board_title"},[s("p",[e._v("欢迎")]),s("p",[e._v("很高兴可以在这个网站运行的")]),s("p",[e._v("第"+e._s(e._f("timeFormat")(e.time))+"遇见你")]),s("p",{model:{value:e.allMessageList,callback:function(t){e.allMessageList=t},expression:"allMessageList"}},[e._v("你是运行以来的第"+e._s(e.allMessageList.length+1)+"位访客")]),s("p",[e._v("在这里你可以畅所欲言")]),s("p",[e._v("或者看看别人有什么想法")])]),s("hr"),s("div",{staticClass:"info_board_form"},[s("el-form",{attrs:{"label-position":"top",model:e.messageForm}},[s("el-form-item",{attrs:{label:"请告诉我该如何称呼你"}},[s("el-input",{attrs:{placeholder:"请输入你的昵称"},model:{value:e.messageForm.name,callback:function(t){e.$set(e.messageForm,"name",t)},expression:"messageForm.name"}})],1),s("el-form-item",{attrs:{label:"方便的话可以留个邮箱"}},[s("el-input",{attrs:{placeholder:"请输入你的邮箱"},model:{value:e.messageForm.email,callback:function(t){e.$set(e.messageForm,"email",t)},expression:"messageForm.email"}})],1),s("el-form-item",{attrs:{label:"然后告诉我你想说什么吧"}},[s("el-input",{attrs:{type:"textarea",placeholder:"你也来说两句吧！在此输入留言内容"},model:{value:e.messageForm.content,callback:function(t){e.$set(e.messageForm,"content",t)},expression:"messageForm.content"}})],1),s("p",{staticClass:"tip"},[e._v("隐私说明：你的昵称以及留言内容会被公开展示，但邮箱不会")]),s("el-button",{staticClass:"btn",attrs:{type:"primary",plain:"",disabled:e.submiting},on:{click:e.submitMessage}},[e._v("给我留言")])],1)],1)])]),s("div",{staticClass:"list"},[s("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.$router.push("/")}}},[e._v("返回")]),s("h3",{staticClass:"title"},[e._v("留言板")]),s("p",{staticClass:"title"},[e._v("已有 "+e._s(e.allMessageList.length)+" 人留言")]),s("div",{staticClass:"message"},[e._l(e.showMessageList,(function(t,a){return s("div",{key:a,staticClass:"message_item"},[s("p",{staticClass:"message_item_name"},[e._v(e._s(t.name))]),s("p",{staticClass:"message_item_info"},[e._v(e._s(e._f("dateFormat")(t.time))+e._s(t.city?" 在 ":"")+e._s(t.city)+" 说：")]),s("p",{staticClass:"message_item_content"},[e._v(e._s(t.content))]),s("div",{staticClass:"message_item_list"},[s("div",{staticClass:"mil_item"},[s("img",{staticClass:"mil_item_img",attrs:{src:"https://img2.baidu.com/it/u=3563355710,610829362&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=400",alt:""},on:{click:function(s){return e.agree(t)}}}),s("p",{staticClass:"mil_item_text"},[e._v("言之有理？送一束花")]),s("p",{staticClass:"mil_item_text"},[e._v("(收到的鲜花数："+e._s(t.agree)+")")])]),s("div",{staticClass:"mil_item"},[s("img",{staticClass:"mil_item_img",attrs:{src:"https://img1.baidu.com/it/u=3774984617,214465278&fm=253&fmt=auto&app=138&f=JPEG?w=260&h=260",alt:""},on:{click:function(s){return e.disagree(t)}}}),s("p",{staticClass:"mil_item_text"},[e._v("觉得不对？扔个番茄")]),s("p",{staticClass:"mil_item_text"},[e._v("(被扔的番茄数："+e._s(t.disagree)+")")])])])])})),s("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper",total:e.allMessageList.length},on:{"current-change":e.handleChange}})],2)],1)])},i=[],l={name:"message",data(){return{messageForm:{name:"",email:"",content:""},submiting:!1,time:0,allMessageList:[],showMessageList:[]}},methods:{handleChange(e){this.showMessageList=this.allMessageList.slice(10*(e-1),10*e)},agree(e){this.$ajax.post("message/agree",{id:e.id,disagree:e.disagree,agree:e.agree}).then((e=>{location.reload()}))},disagree(e){this.$ajax.post("message/disagree",{id:e.id,agree:e.agree,disagree:e.disagree}).then((e=>{location.reload()}))},submitMessage(){return""==this.messageForm.name||""==this.messageForm.content?this.$message("给我留言的话，至少要告诉我你的昵称和留言的内容哦"):""==this.messageForm.email||/^([a-zA-Z]|[0-9])(\w)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/.test(this.messageForm.email)?(this.submiting=!0,void this.$ajax.post("message/comment",{...this.messageForm}).then((e=>{this.submiting=!1,this.$message.success("留言成功，后台审核通过后会展示在留言板"),this.messageForm.name="",this.messageForm.email="",this.messageForm.content="",this.$router.go(0)}))):this.$message.warning("你的邮箱格式好像有点问题，要不要再检查一下")}},created(){Promise.all([this.$ajax.get("message/list"),this.$ajax.get("message/server_info")]).then((e=>{this.allMessageList=e[0].data,this.showMessageList=e[0].data.slice(0,10),console.log(e[1].data);const t=new Date(e[1].data).getTime(),s=(new Date).getTime(),a=s-t;this.time=a,setInterval((()=>{this.time+=1e3}),1e3)}))},filters:{dateFormat:e=>{const t=new Date(e);return`${t.getFullYear()}年 ${t.getMonth()+1}月 ${t.getDate()}日`},timeFormat:e=>{const t=e/1e3;let s=Math.floor(t%60),a=Math.floor(t/60),i=0;a>=60&&(i=Math.floor(a/60),a=Math.floor(a%60));let l=0;return i>=24&&(l=Math.floor(i/24),i=Math.floor(i%24)),`${l}天${i}小时${a}分钟${s}秒`}}},m=l,o=s(1001),r=(0,o.Z)(m,a,i,!1,null,"2ae34b16",null),n=r.exports}}]);
//# sourceMappingURL=617.3a73f492.js.map